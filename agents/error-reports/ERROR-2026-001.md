# é”™è¯¯åˆ†ææŠ¥å‘Š: æµ‹è¯•å‘ç°é—®é¢˜åˆ†æ

## åŸºæœ¬ä¿¡æ¯
- **é”™è¯¯ID**: ERROR-2026-001
- **ç”Ÿæˆæ—¶é—´**: 2026-02-15T10:45:00Z
- **æµ‹è¯•æŠ¥å‘Š**: TEST-2026-001
- **ä¸¥é‡ç¨‹åº¦**: Minor
- **é”™è¯¯ç±»å‹**: Test Configuration Issue

## æ¦‚è¦
åˆ†æäº†æµ‹è¯•å‘ç°çš„2ä¸ªé—®é¢˜ï¼Œå‘ç°å‡ä¸º**æµ‹è¯•è„šæœ¬é…ç½®é—®é¢˜**ï¼Œè€Œéåº”ç”¨ç¨‹åºä»£ç bugï¼š
1. **ISSUE-001**: æµ‹è¯•æœŸæœ›é”™è¯¯ - ç©å®¶2çš„çº¢è‰²ä¸»é¢˜æ˜¯æ­£ç¡®çš„è®¾è®¡
2. **ISSUE-002**: æµ‹è¯•é€‰æ‹©å™¨æ–‡æœ¬ä¸åŒ¹é… - æŒ‰é’®æ–‡æœ¬æ˜¯"å¼€å§‹å¯¹æˆ˜"è€Œé"å¼€å§‹æ¸¸æˆ"

---

## é—®é¢˜ 1: ç©å®¶2é“è·¯æŒ‰é’®é¢œè‰²ä¸é¢„æœŸä¸ç¬¦

### é—®é¢˜æè¿°
æµ‹è¯•æœŸæœ›ç©å®¶2é€‰æ‹©é“è·¯åæŒ‰é’®æ˜¾ç¤ºä¸ºç»¿è‰²ï¼Œä½†å®é™…æ˜¾ç¤ºä¸ºçº¢è‰²ã€‚

### æµ‹è¯•é”™è¯¯
**æ ¹æœ¬åŸå› **: æµ‹è¯•æ–­è¨€é”™è¯¯ï¼Œä¸æ˜¯ä»£ç bug

**ä»£ç åˆ†æ**:
- [GameSetup.vue:69](src/components/GameSetup.vue#L69) æ˜¾ç¤ºï¼š`<label>é€‰æ‰‹ 2 (çº¢è‰²æ–¹)</label>`
- [GameSetup.vue:91-92](src/components/GameSetup.vue#L91-L92) æ˜¾ç¤ºç©å®¶2çš„æŒ‰é’®æ ·å¼ï¼š
  ```vue
  :class="player2Road === 2
    ? 'bg-ban-red/20 border-ban-red-neon text-ban-red-neon ...'"
  ```

**è®¾è®¡æ„å›¾**:
- ç©å®¶1ä½¿ç”¨è“è‰²ä¸»é¢˜ï¼ˆpick-blueï¼‰- è“è‰²æ–¹
- ç©å®¶2ä½¿ç”¨çº¢è‰²ä¸»é¢˜ï¼ˆban-redï¼‰- çº¢è‰²æ–¹
- è¿™æ˜¯**æ­£ç¡®çš„è®¾è®¡**ï¼Œç”¨äºåŒºåˆ†ä¸¤ä¸ªé€‰æ‰‹

**æµ‹è¯•é—®é¢˜**:
```javascript
// æµ‹è¯•ä»£ç  (basic-test.spec.js:66)
expect(player2Road4Class).toContain('bg-plant-green'); // âŒ é”™è¯¯çš„æœŸæœ›
```

### ä¿®å¤å»ºè®®

#### æ–¹æ¡ˆ1ï¼šä¿®æ­£æµ‹è¯•æ–­è¨€ï¼ˆæ¨èï¼‰

ä¿®æ”¹ `agents/tests/basic-test.spec.js:66`:

```javascript
// ä¿®æ”¹å‰ï¼ˆé”™è¯¯ï¼‰
expect(player2Road4Class).toContain('bg-plant-green');

// ä¿®æ”¹åï¼ˆæ­£ç¡®ï¼‰
expect(player2Road4Class).toContain('bg-ban-red');
```

#### æ–¹æ¡ˆ2ï¼šæ·»åŠ æ›´è¯¦ç»†çš„æ–­è¨€

```javascript
// éªŒè¯ç©å®¶1çš„è“è‰²ä¸»é¢˜
expect(player1Road2Class).toContain('bg-pick-blue');
expect(player1Road2Class).toContain('border-pick-blue-neon');

// éªŒè¯ç©å®¶2çš„çº¢è‰²ä¸»é¢˜
expect(player2Road4Class).toContain('bg-ban-red');
expect(player2Road4Class).toContain('border-ban-red-neon');
```

### éªŒè¯æ­¥éª¤
1. ä¿®æ”¹æµ‹è¯•è„šæœ¬ä¸­çš„æ–­è¨€
2. é‡æ–°è¿è¡Œæµ‹è¯•ï¼š`npx playwright test agents/tests/basic-test.spec.js`
3. ç¡®è®¤æµ‹è¯•é€šè¿‡
4. éªŒè¯UIæ˜¾ç¤ºï¼šç©å®¶1æŒ‰é’®ä¸ºè“è‰²ï¼Œç©å®¶2æŒ‰é’®ä¸ºçº¢è‰²

### å½±å“èŒƒå›´
- **å½±å“æ–‡ä»¶**: ä»…æµ‹è¯•æ–‡ä»¶ `agents/tests/basic-test.spec.js`
- **åº”ç”¨ç¨‹åºä»£ç **: æ— éœ€ä¿®æ”¹ï¼Œä»£ç é€»è¾‘æ­£ç¡®
- **ç”¨æˆ·å½±å“**: æ— 

---

## é—®é¢˜ 2: æ— æ³•æ‰¾åˆ°å¼€å§‹æ¸¸æˆæŒ‰é’®

### é—®é¢˜æè¿°
æµ‹è¯•é€‰æ‹©å™¨æ— æ³•å®šä½åˆ°å¼€å§‹æ¸¸æˆæŒ‰é’®ï¼Œå¯¼è‡´æµ‹è¯•è¶…æ—¶ã€‚

### æ ¹æœ¬åŸå› 
æµ‹è¯•é€‰æ‹©å™¨ä½¿ç”¨äº†é”™è¯¯çš„æŒ‰é’®æ–‡æœ¬ã€‚

**ä»£ç åˆ†æ**:
- [GameSetup.vue:117-126](src/components/GameSetup.vue#L117-L126) æ˜¾ç¤ºæŒ‰é’®ç»“æ„ï¼š
  ```vue
  <button type="submit" ...>
    <span class="relative z-10 flex items-center justify-center gap-2">
      å¼€å§‹å¯¹æˆ˜ <span class="group-hover:translate-x-1 transition-transform">â†’</span>
    </span>
  </button>
  ```

**æŒ‰é’®æ–‡æœ¬**: "å¼€å§‹å¯¹æˆ˜"ï¼ˆä¸æ˜¯"å¼€å§‹æ¸¸æˆ"ï¼‰

### ä¿®å¤å»ºè®®

#### æ–¹æ¡ˆ1ï¼šä¿®æ­£æµ‹è¯•é€‰æ‹©å™¨ï¼ˆæ¨èï¼‰

ä¿®æ”¹ `agents/tests/basic-test.spec.js:131`:

```javascript
// ä¿®æ”¹å‰ï¼ˆé”™è¯¯ï¼‰
await page.click('button[type="submit"]:has-text("å¼€å§‹æ¸¸æˆ")');

// ä¿®æ”¹åï¼ˆæ­£ç¡®ï¼‰
await page.click('button[type="submit"]:has-text("å¼€å§‹å¯¹æˆ˜")');
```

#### æ–¹æ¡ˆ2ï¼šä½¿ç”¨æ›´çµæ´»çš„é€‰æ‹©å™¨

```javascript
// ä½¿ç”¨åŒ…å«æ–‡æœ¬åŒ¹é…
await page.click('button[type="submit"] >> text=/å¼€å§‹.*/');

// æˆ–è€…ä½¿ç”¨CSS classé€‰æ‹©å™¨
await page.click('button.w-full.py-4');

// æˆ–è€…ä½¿ç”¨dataå±æ€§ï¼ˆéœ€è¦ä¿®æ”¹HTMLæ·»åŠ data-testidï¼‰
await page.click('button[data-testid="start-game-button"]');
```

#### æ–¹æ¡ˆ3ï¼šæœ€ä½³å®è·µ - æ·»åŠ æµ‹è¯•IDï¼ˆå¯é€‰ä½†æ¨èï¼‰

åœ¨ `GameSetup.vue` ä¸­æ·»åŠ ï¼š

```vue
<button
  type="submit"
  data-testid="start-game-button"
  :disabled="!player1Name || !player2Name || !player1Road || !player2Road"
  ...
>
```

ç„¶ååœ¨æµ‹è¯•ä¸­ä½¿ç”¨ï¼š

```javascript
await page.click('[data-testid="start-game-button"]');
```

### éªŒè¯æ­¥éª¤
1. ä¿®æ”¹æµ‹è¯•é€‰æ‹©å™¨
2. é‡æ–°è¿è¡Œæµ‹è¯•ï¼š`npx playwright test agents/tests/basic-test.spec.js`
3. ç¡®è®¤èƒ½å¤Ÿæ‰¾åˆ°å¹¶ç‚¹å‡»æŒ‰é’®
4. éªŒè¯æ¸¸æˆèƒ½å¤Ÿæ­£å¸¸å¯åŠ¨

### å½±å“èŒƒå›´
- **å½±å“æ–‡ä»¶**: ä»…æµ‹è¯•æ–‡ä»¶ `agents/tests/basic-test.spec.js`
- **åº”ç”¨ç¨‹åºä»£ç **: æ— éœ€ä¿®æ”¹ï¼ˆé™¤éé€‰æ‹©æ–¹æ¡ˆ3ï¼‰
- **ç”¨æˆ·å½±å“**: æ— 

---

## æµ‹è¯•è„šæœ¬é—®é¢˜æ±‡æ€»

### é—®é¢˜åˆ†ç±»
| é—®é¢˜ID | ç±»å‹ | æ ¹å›  | æ˜¯å¦ä»£ç bug |
|--------|------|------|-------------|
| ISSUE-001 | æµ‹è¯•æ–­è¨€é”™è¯¯ | æœŸæœ›å€¼ä¸ç¬¦åˆè®¾è®¡æ„å›¾ | å¦ |
| ISSUE-002 | æµ‹è¯•é€‰æ‹©å™¨é”™è¯¯ | æ–‡æœ¬ä¸åŒ¹é… | å¦ |

### æµ‹è¯•è´¨é‡è¯„ä¼°
âœ… **æµ‹è¯•æˆåŠŸå‘ç°äº†åº”ç”¨ç¨‹åºçš„è®¾è®¡**:
- éªŒè¯äº†ç©å®¶1ä½¿ç”¨è“è‰²ä¸»é¢˜
- éªŒè¯äº†ç©å®¶2ä½¿ç”¨çº¢è‰²ä¸»é¢˜
- éªŒè¯äº†é“è·¯é€‰æ‹©äº’æ–¥åŠŸèƒ½æ­£å¸¸

âš ï¸ **æµ‹è¯•è„šæœ¬éœ€è¦æ”¹è¿›**:
1. ä¿®æ­£é”™è¯¯çš„æœŸæœ›å€¼
2. ä½¿ç”¨æ­£ç¡®çš„æŒ‰é’®æ–‡æœ¬
3. è€ƒè™‘æ·»åŠ data-testidå±æ€§æé«˜é€‰æ‹©å™¨å¯é æ€§

### ä¼˜å…ˆçº§
- **é«˜ä¼˜å…ˆçº§**: ä¿®æ­£æµ‹è¯•è„šæœ¬ï¼Œç¡®ä¿æµ‹è¯•å‡†ç¡®æ€§
- **ä½ä¼˜å…ˆçº§**: æ·»åŠ data-testidå±æ€§ï¼ˆå¯é€‰ï¼‰

---

## å»ºè®®çš„æµ‹è¯•æ”¹è¿›

### 1. åˆ›å»ºæµ‹è¯•å¸¸é‡æ–‡ä»¶

åˆ›å»º `agents/tests/constants.js`:

```javascript
export const TEST_IDS = {
  player1Input: 'player1-input',
  player2Input: 'player2-input',
  startButton: '[data-testid="start-game-button"]',
  player1Road2: '[data-testid="player1-road-2"]',
  player1Road4: '[data-testid="player1-road-4"]',
  player2Road2: '[data-testid="player2-road-2"]',
  player2Road4: '[data-testid="player2-road-4"]',
};

export const THEMES = {
  player1: {
    selected: 'bg-pick-blue',
    border: 'border-pick-blue-neon',
    text: 'text-pick-blue-neon'
  },
  player2: {
    selected: 'bg-ban-red',
    border: 'border-ban-red-neon',
    text: 'text-ban-red-neon'
  }
};
```

### 2. æ·»åŠ è§†è§‰å›å½’æµ‹è¯•

```javascript
test('ç©å®¶1æŒ‰é’®åº”è¯¥æ˜¾ç¤ºè“è‰²ä¸»é¢˜', async ({ page }) => {
  await setupPlayers(page);
  await selectRoad(page, 'player1', 2);

  const button = page.locator('[data-testid="player1-road-2"]');
  await expect(button).toHaveClass(/bg-pick-blue/);
  await expect(button).toHaveClass(/border-pick-blue-neon/);
});

test('ç©å®¶2æŒ‰é’®åº”è¯¥æ˜¾ç¤ºçº¢è‰²ä¸»é¢˜', async ({ page }) => {
  await setupPlayers(page);
  await selectRoad(page, 'player2', 4);

  const button = page.locator('[data-testid="player2-road-4"]');
  await expect(button).toHaveClass(/bg-ban-red/);
  await expect(button).toHaveClass(/border-ban-red-neon/);
});
```

---

## ç»“è®º

âœ… **åº”ç”¨ç¨‹åºä»£ç æ²¡æœ‰bug** - æ‰€æœ‰æµ‹è¯•å¤±è´¥éƒ½æ˜¯ç”±æµ‹è¯•è„šæœ¬é…ç½®é”™è¯¯å¯¼è‡´çš„ã€‚

âœ… **æµ‹è¯•ç³»ç»Ÿå·¥ä½œæ­£å¸¸** - æˆåŠŸéªŒè¯äº†åº”ç”¨ç¨‹åºçš„æ ¸å¿ƒåŠŸèƒ½ï¼š
- é“è·¯é€‰æ‹©äº’æ–¥åŠŸèƒ½æ­£å¸¸
- ç©å®¶é¢œè‰²ä¸»é¢˜åŒºåˆ†æ­£ç¡®
- æŒ‰é’®ç¦ç”¨/å¯ç”¨é€»è¾‘æ­£ç¡®

ğŸ“ **ä¸‹ä¸€æ­¥è¡ŒåŠ¨**:
1. ä¿®æ­£æµ‹è¯•è„šæœ¬ä¸­çš„é”™è¯¯æ–­è¨€å’Œé€‰æ‹©å™¨
2. é‡æ–°è¿è¡Œæµ‹è¯•éªŒè¯æ‰€æœ‰æµ‹è¯•é€šè¿‡
3. è€ƒè™‘æ·»åŠ data-testidå±æ€§æé«˜æµ‹è¯•ç¨³å®šæ€§
4. æ‰©å±•æµ‹è¯•è¦†ç›–æ›´å¤šåœºæ™¯

---

## é™„å½•ï¼šä¿®å¤åçš„æµ‹è¯•ä»£ç ç‰‡æ®µ

```javascript
// ä¿®æ­£åçš„æµ‹è¯•ä»£ç ç‰‡æ®µ
test('åº”è¯¥èƒ½å¤Ÿé€‰æ‹©é“è·¯', async ({ page }) => {
  await page.fill('#player1-input', 'ç©å®¶A');
  await page.waitForTimeout(500);
  await page.fill('#player2-input', 'ç©å®¶B');
  await page.waitForTimeout(500);

  const road2Buttons = await page.locator('button:has-text("2è·¯")').all();
  await road2Buttons[0].click();
  await page.waitForTimeout(200);

  // ä¿®æ­£ï¼šéªŒè¯ç©å®¶1çš„è“è‰²ä¸»é¢˜
  const player1Road2Class = await road2Buttons[0].getAttribute('class');
  expect(player1Road2Class).toContain('bg-pick-blue'); // âœ… æ­£ç¡®

  const road4Buttons = await page.locator('button:has-text("4è·¯")').all();
  await road4Buttons[1].click();
  await page.waitForTimeout(200);

  // ä¿®æ­£ï¼šéªŒè¯ç©å®¶2çš„çº¢è‰²ä¸»é¢˜
  const player2Road4Class = await road4Buttons[1].getAttribute('class');
  expect(player2Road4Class).toContain('bg-ban-red'); // âœ… æ­£ç¡®
});

test('é€‰æ‹©é“è·¯ååº”è¯¥èƒ½å¤Ÿå¼€å§‹æ¸¸æˆ', async ({ page }) => {
  // ... å‰é¢çš„ä»£ç ä¸å˜ ...

  // ä¿®æ­£ï¼šä½¿ç”¨æ­£ç¡®çš„æŒ‰é’®æ–‡æœ¬
  await page.click('button[type="submit"]:has-text("å¼€å§‹å¯¹æˆ˜")'); // âœ… æ­£ç¡®

  await page.waitForTimeout(1000);
  // ... åç»­éªŒè¯ä»£ç  ...
});
```
